<html>
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=US-ASCII">
<META HTTP-EQUIV="Expires" CONTENT="Tue, 09 Aug 2050 22:16:01 GMT">
<title>
CSimpleSocket - C++ cross platform socket library
</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="foo.css" rel="stylesheet" type="text/css">
<LINK REV="made" href="mailto:mark@carrierlabs.com">
<META NAME="keywords" CONTENT="Sockets, TCP, UDP, Berkley Sockets, C++ socket library, carrierlabs, Mark Carrier">
<META NAME="description" CONTENT="C++ cross platform Berkley Socket class for build TCP and UDP sockets.">
<META NAME="author" CONTENT="Mark Carrier">
<META NAME="ROBOTS" CONTENT="ALL">
<!-- Metadata generated by http://vancouver-webpages.com/META/mk-metas.html -->
</head>

<body bgcolor="#ffffff"> 
<table width="100%">
  <tr>
    <td width="40%" align="left" valign="center">
      <a href="http://sockets.carrierlabs.com">
      CSocket project page
      </a>
    </td>
    <td>
    </td>
    <td width="40%" align="right" valign="center">
      <a href="http://sockets.carrierlabs.com">CSocket home page</a>
    </td>
  </tr>
</table>

<hr>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="socket_cookbook">SimpleSocket Cookbook </a></h1>Here is a short cookbook to help you get started.<h2><a class="anchor" name="socket_overview">
Simple Socket Class Overview</a></h2>
Network communications via sockets can be abstracted into two categories of functionality; the <a class="el" href="classCActiveSocket.html">active socket </a> and the <a class="el" href="classCPassiveSocket.html">passive socket. </a> The <a class="el" href="classCActiveSocket.html">active socket </a> object initiates a connection with a known host, whereas the <a class="el" href="classCPassiveSocket.html">passive socket </a> object waits (or listens) for inbound requests for communication. The functionality of both objects is identical as far as sending and receiving data. This library makes distinction between the two objects because the operations for constructing and destructing the two are different.<p>
This library is different from other socket libraries which define TCP sockets, UDP sockets, HTTP sockets, etc. The reason is the operations required for TCP, UDP, and RAW network communication is identical from a logical stand point. Thus a program could initially be written employing TCP streams, and then at some future point it could be discovered that UDP datagrams would satisify the solution. Changing between the two transport protocols would only require changing how the object is instantiated. The remaining code would in theory require minimal to no changes.<p>
This library avoids abstractions like HTTP socket, or SMTP socket, soley because this type of object mixes the application and the transport layer. These types of abstractions can be created using this library as a base class.<p>
The simple socket library is comprised of two class which can be used to represent all socket communications.<p>
<ul>
<li><a class="el" href="classCActiveSocket.html">Active Socket Class </a></li><li><a class="el" href="classCPassiveSocket.html">Passive Socket Class </a></li></ul>
<p>
<dl class="user" compact><dt><b>Socket Class Overview</b></dt><dd></dd></dl>
When operating on a socket object most methods will return <b>true</b> or <b>false</b> <h2><a class="anchor" name="simple_acitve_socket">
Simple Active Socket</a></h2>
As mentioned previously the active socket (<a class="el" href="classCActiveSocket.html" title="Provides a platform independent class to create an active socket.">CActiveSocket</a>) is used to initiate a connections with a server on some known port. So you want to connect to an existing server...<p>
How do you do it?<p>
There are many ways using the existing Berkley Socket API, but the goal of this class is to remove the many calls and man page lookups and replace them with clear, concise set of methods which allow a developer to focus on the logic of network programming.<p>
The following code will connect to a DAYTIME server on port 13, query for the current time, and close the socket.<p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;string.h&gt;</span>
<span class="preprocessor">#include "<a class="code" href="ActiveSocket_8h.html">ActiveSocket.h</a>"</span>       <span class="comment">// Include header for active socket object definition</span>

<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
{
    <a class="code" href="classCActiveSocket.html" title="Provides a platform independent class to create an active socket.">CActiveSocket</a> socket;       <span class="comment">// Instantiate active socket object (defaults to TCP).</span>
    <span class="keywordtype">char</span>          time[50];

    memset(&amp;time, 0, 50);

    <span class="comment">//--------------------------------------------------------------------------</span>
    <span class="comment">// Initialize our socket object </span>
    <span class="comment">//--------------------------------------------------------------------------</span>
    socket.<a class="code" href="classCSimpleSocket.html#e50622a90672c5c697f2ec7a3a7eec06" title="Initialize instance of CSocket.">Initialize</a>();

    <span class="comment">//--------------------------------------------------------------------------</span>
    <span class="comment">// Create a connection to the time server so that data can be sent</span>
    <span class="comment">// and received.</span>
    <span class="comment">//--------------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (socket.<a class="code" href="classCActiveSocket.html#5701a40f547abb0f71b7c94e998c0008" title="Established a connection to the address specified by pAddr.">Open</a>((<span class="keyword">const</span> uint8 *)<span class="stringliteral">"time-C.timefreq.bldrdoc.gov"</span>, 13))
    {
        <span class="comment">//----------------------------------------------------------------------</span>
        <span class="comment">// Send a requtest the server requesting the current time.</span>
        <span class="comment">//----------------------------------------------------------------------</span>
        <span class="keywordflow">if</span> (socket.<a class="code" href="classCSimpleSocket.html#cfd665d8d563b9d805c97a8ec9b66906" title="Attempts to send a block of data on an established connection.">Send</a>((<span class="keyword">const</span> uint8 *)<span class="stringliteral">"\n"</span>, 1))
        {
            <span class="comment">//------------------------------------------------------------------</span>
            <span class="comment">// Receive response from the server.</span>
            <span class="comment">//------------------------------------------------------------------</span>
            socket.<a class="code" href="classCSimpleSocket.html#973c8856b081fa4d784d5a9751549b76" title="Attempts to receive a block of data on an established connection.">Receive</a>(49);
            memcpy(&amp;time, socket.<a class="code" href="classCSimpleSocket.html#706d748dcef01b3f68d6927e4fe4eb20" title="Get a pointer to internal receive buffer.">GetData</a>(), 49);
            printf(<span class="stringliteral">"%s\n"</span>, time);

            <span class="comment">//------------------------------------------------------------------</span>
            <span class="comment">// Close the connection.</span>
            <span class="comment">//------------------------------------------------------------------</span>
            socket.<a class="code" href="classCSimpleSocket.html#fbb30cef80ae0faec59403184cab3bb1" title="Close socket.">Close</a>();
        }
    }


    <span class="keywordflow">return</span> 1;
}
</pre></div><p>
You can see that the amount of code required to an object for network communciation is very small and simple.<h2><a class="anchor" name="simple_passive_socket">
Simple Passive Socket</a></h2>
Now you want to build a server.<p>
How do you do it?<p>
For a practical test lets build an echo server. The server will listen on port 6789 an repsond back with what ever has been sent to the server.<p>
<div class="fragment"><pre class="fragment"><span class="comment">//------------------------------------------------------------------------------</span>
<span class="comment">// ECHO SERVER CODE</span>
<span class="comment">//------------------------------------------------------------------------------</span>
<span class="preprocessor">#include "<a class="code" href="PassiveSocket_8h.html">PassiveSocket.h</a>"</span>       <span class="comment">// Include header for active socket object definition</span>

<span class="preprocessor">#define MAX_PACKET 4096 </span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
{
    <a class="code" href="classCPassiveSocket.html" title="Provides a platform independent class to create a passive socket.">CPassiveSocket</a> socket;
    <a class="code" href="classCActiveSocket.html" title="Provides a platform independent class to create an active socket.">CActiveSocket</a> *pClient = NULL;

    <span class="comment">//--------------------------------------------------------------------------</span>
    <span class="comment">// Initialize our socket object </span>
    <span class="comment">//--------------------------------------------------------------------------</span>
    socket.<a class="code" href="classCSimpleSocket.html#e50622a90672c5c697f2ec7a3a7eec06" title="Initialize instance of CSocket.">Initialize</a>();

    socket.<a class="code" href="classCPassiveSocket.html#d6e2b48e34107deaff2a0fb5ca0d0667" title="Create a listening socket at local ip address &amp;#39;x.x.x.x&amp;#39; or &amp;#39;localhost&amp;#39;...">Listen</a>((<span class="keyword">const</span> uint8 *)<span class="stringliteral">"127.0.0.1"</span>, 6789);

    <span class="keywordflow">while</span> (<span class="keyword">true</span>)
    {
        <span class="keywordflow">if</span> ((pClient = socket.<a class="code" href="classCPassiveSocket.html#7749bf8e1d5a54de5ddc852584bf4a0d" title="Extracts the first connection request on the queue of pending connections and creates...">Accept</a>()) != NULL)
        {
            <span class="comment">//------------------------------------------------------------------</span>
            <span class="comment">// Receive request from the client.</span>
            <span class="comment">//------------------------------------------------------------------</span>
            <span class="keywordflow">if</span> (pClient-&gt;<a class="code" href="classCSimpleSocket.html#973c8856b081fa4d784d5a9751549b76" title="Attempts to receive a block of data on an established connection.">Receive</a>(MAX_PACKET))
            {
                <span class="comment">//--------------------------------------------------------------</span>
                <span class="comment">// Send response to client and close connection to the client.</span>
                <span class="comment">//--------------------------------------------------------------</span>
                pClient-&gt;<a class="code" href="classCSimpleSocket.html#cfd665d8d563b9d805c97a8ec9b66906" title="Attempts to send a block of data on an established connection.">Send</a>((<span class="keyword">const</span> uint8 *)pClient-&gt;<a class="code" href="classCSimpleSocket.html#706d748dcef01b3f68d6927e4fe4eb20" title="Get a pointer to internal receive buffer.">GetData</a>(), pClient-&gt;<a class="code" href="classCSimpleSocket.html#d0e9ba20a79d885263a37d302d965384" title="Returns the number of bytes received on the last call to CSocket::Receive().">GetBytesReceived</a>());
                pClient-&gt;<a class="code" href="classCSimpleSocket.html#fbb30cef80ae0faec59403184cab3bb1" title="Close socket.">Close</a>();
            }

            <span class="keyword">delete</span> pClient;
        }
    }

    <span class="comment">//--------------------------------------------------------------------------</span>
    <span class="comment">// Receive request from the client.</span>
    <span class="comment">//--------------------------------------------------------------------------</span>
    socket.<a class="code" href="classCSimpleSocket.html#fbb30cef80ae0faec59403184cab3bb1" title="Close socket.">Close</a>();

    <span class="keywordflow">return</span> 1;
}

<span class="comment">//------------------------------------------------------------------------------</span>
<span class="comment">// Echo Server Client</span>
<span class="comment">//------------------------------------------------------------------------------</span>
<span class="preprocessor">#include &lt;string.h&gt;</span>
<span class="preprocessor">#include "<a class="code" href="ActiveSocket_8h.html">ActiveSocket.h</a>"</span>       <span class="comment">// Include header for active socket object definition</span>

<span class="preprocessor">#define TEST_PACKET "TestPacket"</span>
<span class="preprocessor"></span><span class="preprocessor">#define MAX_PACKET  1024</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
{
    <a class="code" href="classCActiveSocket.html" title="Provides a platform independent class to create an active socket.">CActiveSocket</a> socket;       <span class="comment">// Instantiate active socket object (defaults to TCP).</span>
    <span class="keywordtype">char</span>          szData[MAX_PACKET];

    memset(szData, 0, MAX_PACKET);

    <span class="comment">//--------------------------------------------------------------------------</span>
    <span class="comment">// Initialize our socket object</span>
    <span class="comment">//--------------------------------------------------------------------------</span>
    socket.<a class="code" href="classCSimpleSocket.html#e50622a90672c5c697f2ec7a3a7eec06" title="Initialize instance of CSocket.">Initialize</a>();

    <span class="comment">//--------------------------------------------------------------------------</span>
    <span class="comment">// Create a connection to the time server so that data can be sent</span>
    <span class="comment">// and received.</span>
    <span class="comment">//--------------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (socket.<a class="code" href="classCActiveSocket.html#5701a40f547abb0f71b7c94e998c0008" title="Established a connection to the address specified by pAddr.">Open</a>((<span class="keyword">const</span> uint8 *)<span class="stringliteral">"localhost"</span>, 6789))
    {
        <span class="comment">//----------------------------------------------------------------------</span>
        <span class="comment">// Send a requtest the server requesting the current time.</span>
        <span class="comment">//----------------------------------------------------------------------</span>
        <span class="keywordflow">if</span> (socket.<a class="code" href="classCSimpleSocket.html#cfd665d8d563b9d805c97a8ec9b66906" title="Attempts to send a block of data on an established connection.">Send</a>((<span class="keyword">const</span> uint8 *)TEST_PACKET, strlen(TEST_PACKET)))
        {
            <span class="comment">//------------------------------------------------------------------</span>
            <span class="comment">// Receive response from the server.</span>
            <span class="comment">//------------------------------------------------------------------</span>
            socket.<a class="code" href="classCSimpleSocket.html#973c8856b081fa4d784d5a9751549b76" title="Attempts to receive a block of data on an established connection.">Receive</a>(1024);

            strncpy(szData, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)socket.<a class="code" href="classCSimpleSocket.html#706d748dcef01b3f68d6927e4fe4eb20" title="Get a pointer to internal receive buffer.">GetData</a>(), socket.<a class="code" href="classCSimpleSocket.html#d0e9ba20a79d885263a37d302d965384" title="Returns the number of bytes received on the last call to CSocket::Receive().">GetBytesReceived</a>());
            printf(<span class="stringliteral">"%s\n"</span>, szData);

            <span class="comment">//------------------------------------------------------------------</span>
            <span class="comment">// Close the connection.</span>
            <span class="comment">//------------------------------------------------------------------</span>
            socket.<a class="code" href="classCSimpleSocket.html#fbb30cef80ae0faec59403184cab3bb1" title="Close socket.">Close</a>();
        }
    }


    <span class="keywordflow">return</span> 1;
}
</pre></div> You can see that the amount of code used to do this is very small, very easy to read, and very flexible. </div>
<hr>
<table width="100%">
  <tr>
    <td width="10%" align="left" valign="center">
      <a href="http://www.carrierlabs.com"> 
      <img src="carrierlabs.jpg" width="120" height="62" border="0" alt="CarrierLabs Logo"/></a>
    </td>

    <td width="35%" align="left" valign="center">
      hosts this site.
    </td>

    <td>
<!-- Counter Code START -->
<table id="counter" onmouseover="fun();" onmouseout="nd();" cellspacing="0" cellpadding="0"><tr><td>
<center><table cellspacing="0" cellpadding="0"><tr><td><a href="http://www.visitorcounters.org/"><img style="border: 0;" src="http://www.visitorcounters.org/counter.php?type=1&id=MTUwNzI=" alt="free hit counter" title="free hit counter"/></a></td><td><a href="http://www.salvagedata.co.uk"><img style="border: 0;" src="http://www.visitorcounters.org/counter.php?type=2&id=MTUwNzI=" alt="data recovery" title="data recovery"/></a></td></tr></table></center></td></tr>
<tr><td>
<center><a href="http://www.salvagedata.com" target="_blank"><span style="font-size:11px;">data recovery services</span></a></center></td></tr>
</table>
<script type="text/javascript" src="http://www.visitorcounters.org/getCode.php?id=MTUwNzI="></script>
<!-- Counter Code END -->
    </td>
<td>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="1136058">
<input type="image" src="https://www.paypal.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="">
<img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>

</td>
    <td align="right" valign="center">
      Send comments to:<br>
      <a href="mailto:mark@carrierlabs.com">CarrierLabs Developers</a>
    </td>
  </tr>
</table>

</body> 
</html>
